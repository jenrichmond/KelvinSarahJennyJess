---
title: "mtt_study3_plotting"
author: "Jen Richmond"
date: "01/09/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# load packages

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(janitor)
library(ggeasy)
library(here)
```

# read data

```{r}
mtt_long <- read_csv(here("data", "study3_clean_mtt.csv"))
```

# OVERGENERALITY

Each participant was asked to talk about 2 events in each condition category 

- past, neutral
- past, negative
- past, positive
- future, neutral
- future, negative
- future, positive

These 12 events were coded as 1 = general, 2 = categorical, 3 = specific. Only specific events can be coded for internal vs. external details. 

The dummy coding involved adding these codes together for each condition combination resulting in a max score of 6 if participants came up with 2 x specific events, and a minimum score of 2 if they produced 2 x general events. 


```{r}
event_scores <- mtt_long %>%
  group_by(group, direction, valence) %>%  # for each combination of direction/valence
  count(px_no, code)  


dummy_scores <- event_scores %>% 
  mutate(dummy_score = code * n) # new column calc dummy score

overgen <- dummy_scores %>%
  group_by(px_no, group, direction, valence) %>%
  summarise(dummy_total = sum(dummy_score)) # for each pp, direction, valence, add the total dummy score together

overgen$valence <- fct_relevel(overgen$valence, c("pos", "neutral", "neg"))
```

### summary plots

#### make summary df
```{r}

overgen_summary <- overgen %>%
  group_by(valence, group, direction) %>%
  summarise(mean = mean(dummy_total, na.rm = TRUE), 
            sd = sd(dummy_total, na.rm = TRUE), 
            n = n(), 
            stderr = sd/sqrt(n)) 
```

##### PAST vs FUTURE plot 

... by group and valence 
```{r}
overgen_summary %>%
  filter(direction == "past") %>%
  ggplot(aes(x = valence, y = mean, fill = valence)) +
  geom_col() +
  geom_errorbar(aes(ymin=mean-stderr, ymax=mean+stderr),
                  size=.3,    # Thinner lines
                    width=.2,
                      position=position_dodge(.9)) +
  facet_wrap(~ group) +
  scale_fill_brewer(palette="Dark2") +
  labs(title = "PAST overgenerality scores by group and valence")

overgen_summary %>%
  filter(direction == "future") %>%
  ggplot(aes(x = valence, y = mean, fill = valence)) +
  geom_col() +
  geom_errorbar(aes(ymin=mean-stderr, ymax=mean+stderr),
                  size=.3,    # Thinner lines
                    width=.2,
                      position=position_dodge(.9)) +
  facet_wrap(~ group) +
  scale_fill_brewer(palette="Dark2") +
  labs(title = "FUTURE overgenerality scores by group and valence")

```


# playing


```{r}
mtt_long %>%
  ggplot(aes(x = code, fill = group)) +
  geom_bar() +
  facet_wrap(~group) +
  labs(title = "distribution of event type by group", subtitle = "1 = general, 2 = categorical, 3 = specific") 
```

Most events are specific, but it looks like anx group has fewer events in general. 


```{r}
mtt_long %>%
  ggplot(aes(x = code, fill = group)) +
  geom_bar() +
  facet_wrap(~px_no) +
  labs(title = "distribution of event type by group", subtitle = "1 = general, 2 = categorical, 3 = specific")

```

```{r}
mtt_long %>%
  filter(direction == "past") %>%
  ggplot(aes(x = code, fill = group)) +
  geom_bar() +
  facet_wrap(~px_no) +
  labs(title = "PAST: distribution of event type by group", subtitle = "1 = general, 2 = categorical, 3 = specific")
```

```{r}
mtt_long %>%
  filter(direction == "future") %>%
  ggplot(aes(x = code, fill = group)) +
  geom_bar() +
  facet_wrap(~px_no) +
  labs(title = "FUTURE: distribution of event type by group", subtitle = "1 = general, 2 = categorical, 3 = specific")
```

